# listHostnamesComplete.py
# wsadmin Jython script to print nodeName: hostName for
# DMGR, Node Agents, and WebSphere Web Servers

# Helper to drop a trailing ')' from wsadmin output entries
def strip_trailing_paren(s):
    if s.endswith(')'):
        return s[:-1]
    return s

# Process DMGR and Node Agent entries
def printNodeHostMappings(entries):
    for entry in entries:
        # entry example: "dmgr(cells/myCell/nodes/mgrNode/servers/dmgr|server.xml)"
        cfgPath  = strip_trailing_paren(entry.split('(', 1)[1])
        nodePath = cfgPath.split('|', 1)[0]               # "cells/myCell/nodes/mgrNode/servers/dmgr"
        parts    = nodePath.split('/')
        cellName = parts[1]
        nodeName = parts[3]
        nodeId   = AdminConfig.getid('/Cell:%s/Node:%s/' % (cellName, nodeName))
        hostName = AdminConfig.showAttribute(nodeId, 'hostName')
        print '%s: %s' % (nodeName, hostName)

# --- Main Execution ---

# 1. Deployment Manager (DMGR)
dmgrEntries = AdminTask.listServers('[-serverType DEPLOYMENT_MANAGER]').splitlines()
printNodeHostMappings(dmgrEntries)

# 2. Node Agents
nodeAgentEntries = AdminTask.listServers('[-serverType NODE_AGENT]').splitlines()
printNodeHostMappings(nodeAgentEntries)

# 3. WebSphere Web Servers
#    List WebServer objects directly (Server objects lack hostName) :contentReference[oaicite:6]{index=6}
webServers = AdminConfig.list('WebServer').splitlines()
for wsId in webServers:
    # wsId example: "(cells/cell1/nodes/node1/servers/WebServer01|server.xml#WebServer_...)" or similar
    name   = AdminConfig.showAttribute(wsId, 'name')      # logical WebServer name :contentReference[oaicite:7]{index=7}
    host   = AdminConfig.showAttribute(wsId, 'hostName')  # configured hostname :contentReference[oaicite:8]{index=8}
    print '%s: %s' % (name, host)
