# getSecurePorts_entry_fixed.py
# wsadmin.sh -lang jython -f getSecurePorts_entry_fixed.py \
#    -conntype SOAP -host <dmgrHost> -port <dmgrPort>

import java

sep = java.lang.System.getProperty('line.separator')

# 1. Cell name
cellId   = AdminConfig.list('Cell').splitlines()[0]
cellName = cellId.split('(')[0]

# 2. Walk each ServerEntry (includes AppServers + DMGR)
for srvEntry in AdminConfig.list('ServerEntry').splitlines():  # config ID strings
    srvName  = srvEntry.split('(')[0]
    # Extract nodeName from the config ID path
    nodeName = srvEntry.split('/')[3]  # splits on '/', index 3 is the node :contentReference[oaicite:4]{index=4}

    # 3. Find the WC_defaulthost_secure endpoint under ServerEntry
    for nep in AdminConfig.list('NamedEndPoint', srvEntry).split(sep):
        if not nep.strip():
            continue
        if AdminConfig.showAttribute(nep, 'endPointName') == 'WC_defaulthost_secure':
            epRef = AdminConfig.showAttribute(nep, 'endPoint')
            host  = AdminConfig.showAttribute(epRef, 'host')
            port  = AdminConfig.showAttribute(epRef, 'port')
            print "%s %s %s %s %s" % (
                cellName, nodeName, srvName, host, port)
