SELECT
  p.PROJECT_NAME                              AS process_app,
  SUM(CASE
        WHEN COALESCE(i.CREATE_TIME, i.START_TIME) >= (CURRENT_TIMESTAMP - 3 MONTHS)
        THEN 1 ELSE 0
      END)                                    AS last_3_months_count,
  SUM(CASE
        WHEN COALESCE(i.CREATE_TIME, i.START_TIME) >= (CURRENT_TIMESTAMP - 6 MONTHS)
        THEN 1 ELSE 0
      END)                                    AS last_6_months_count
FROM LSW_BPD_INSTANCE i
JOIN LSW_SNAPSHOT s ON i.SNAPSHOT_ID = s.SNAPSHOT_ID
JOIN LSW_PROJECT  p ON s.PROJECT_ID  = p.PROJECT_ID
-- Optional: filter by status if your schema uses it, e.g. only active/completed
-- WHERE i.STATUS IN (0,1,2)
GROUP BY p.PROJECT_NAME
ORDER BY p.PROJECT_NAME;
